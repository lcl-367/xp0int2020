<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<h1>张三的flag</h1>
<form action="the_real_f1ag_is_h3re.php" method="post">
  <p>猜猜张三的flag是啥: <input type="text" name="flag" /></p>
  <input type="submit" value="Submit" />
</form>
</html>


<?php
header("Content-Type: text/html;charset=utf-8");
session_start();
$str = '';
$all_alpha = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
if($_GET['source']==='1')
	highlight_file('source_sql.txt');

if(!isset($_SESSION['random_num'])){
	$_SESSION['random_num']=rand(0,99999999999);
}

mt_srand($_SESSION['random_num']);


$flag_len = 30;
for ( $i = 0; $i < $flag_len; $i++ ){
    $str.=substr($all_alpha, mt_rand(0, strlen($all_alpha) - 1), 1);       
}
$flag_show = substr($str, 0, 11);
echo "<p>".'我偷看到了张三的一部分flag:'.$flag_show."</p>";


if(isset($_POST['flag'])){
    if($_POST['flag']===$str){
        echo "<p>你真是个小天才，给你ctf{mt_rand_is_s0_weak_and_y0u_can_bre4k}</p>";
    }
    else{
        echo "<p>小盆友，你对张三的flag一无所知</p>";
    }
}
?>






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<!-- ?source=1 -->
